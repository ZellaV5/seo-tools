<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>æ‰¹é‡ URL è®¿é—®å·¥å…·</title>
</head>
<body>
  <h2>æ‰¹é‡URLç¼“å­˜æ¸…ç†å·¥å…·</h2>
  <textarea id="userUrls" placeholder="è¯·è¾“å…¥å¤šä¸ª URLï¼Œæ¯è¡Œä¸€ä¸ª" rows="10" style="width: 600px;"></textarea><br>
  <button onclick="runBatchTask()">æ‰§è¡Œä»»åŠ¡</button>

  <div id="output" style="margin-top: 20px;"></div>

  <script>
    function runBatchTask() {
      const inputText = document.getElementById('userUrls').value.trim();
      if (!inputText) {
        alert('è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ª URL');
        return;
      }

      const urls = inputText.split('\n').map(url => url.trim()).filter(Boolean);
      let cdnList = [];

      for (const input of urls) {
        if (!input.startsWith('http')) {
          alert(`URL æ ¼å¼é”™è¯¯ï¼š${input}`);
          continue;
        }

        try {
          const urlObj = new URL(input);
          let path = urlObj.pathname;
          if (!path.endsWith('/')) path += '/';

          const firstVisit = `https://marketing-site-next-643-pro-aws-oregon.everimaging.cn/_cache?url=${path}`;
          window.open(firstVisit, '_blank');

          let cdnUrl = input.endsWith('/') ? input.slice(0, -1) + '*' : input + '*';
          cdnList.push(cdnUrl);

        } catch (e) {
          alert(`URL è§£æå¤±è´¥ï¼š${input}`);
        }
      }

      // å±•ç¤ºæ‰€æœ‰ CDN æäº¤åœ°å€
      const outputHtml = `
        <p>ğŸ‘‰ ç¬¬äºŒæ­¥è¯·å‰å¾€ <a href="http://cdn.everimaging.cn/cdn/" target="_blank">CDN æäº¤é¡µé¢</a>ï¼Œæ‰‹åŠ¨æäº¤ä»¥ä¸‹åœ°å€ï¼ˆå¸¦ *ï¼‰ï¼š</p>
        <ul>${cdnList.map(url => `<li><code>${url}</code></li>`).join('')}</ul>
      `;
      document.getElementById('output').innerHTML = outputHtml;
    }
  </script>
</body>
</html>
